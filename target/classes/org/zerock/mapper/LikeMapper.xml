<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.zerock.mapper.LikeMapper">

<insert id="insertLike">
<selectKey keyProperty="likeno" order="BEFORE" resultType="long">
select seq_res_like.nextval from dual
</selectKey>

insert into res_like (likeno, userno, resno)
values (#{likeno}, #{userno}, #{resno})
</insert>

<delete id="deleteLike">
      DELETE FROM res_like
      WHERE likeno = #{likeno} AND userno = #{userno}
</delete>

<select id="updateLike">
      UPDATE restaurant SET likecnt = (SELECT COUNT(*)
      FROM res_like WHERE resno = #{resno}) WHERE resno = #{resno}
</select>

<select id="getLike" resultType="int">
      SELECT COUNT(likeno) FROM res_like WHERE resno = #{resno} AND userno = #{userno}
</select>

</mapper>