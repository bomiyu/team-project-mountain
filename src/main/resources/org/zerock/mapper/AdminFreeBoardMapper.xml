<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.zerock.mapper.AdminFreeBoardMapper">

<sql id="criteria">
		<where>
		<foreach item="type" collection="typeArr" separator="OR">
			<choose>
				<when test="type == 'I'.toString()">
					id LIKE '%' || #{keyword} || '%'
				</when>
				<when test="type == 'N'.toString()">
					nickname LIKE '%' || #{keyword} || '%'
				</when>
				<when test="type == 'T'.toString()">
					title LIKE '%' || #{keyword} || '%'
				</when>
				<when test="type == 'C'.toString()">
					content LIKE '%' || #{keyword} || '%'
				</when>
			</choose>
		</foreach>
	</where>
</sql>

<select id="getMemberListPaging" resultType="org.zerock.domain.admin.AdminFreeBoardVO">
<![CDATA[SELECT no, title, content, regdate, member_no, user_nickname FROM
(SELECT ROW_NUMBER() OVER (ORDER BY no DESC) rn, no, title, content, regdate, member_no, user_nickname FROM freeboard
]]>
	 <include refid="criteria"></include>

<![CDATA[
)
WHERE rn BETWEEN (#{pageNo} -1) * #{amount} + 1 AND #{pageNo} * #{amount}]]> 
</select>

<select id="read" resultType="org.zerock.domain.admin.AdminFreeBoardVO">
SELECT no, title, content, regdate, member_no, user_nickname FROM freeboard WHERE no = #{no}
</select>

<select id="getMemberTotalCnt" resultType="int">
	SELECT count(*) FROM freeboard
</select>

<delete id="deleteBoard" >
	delete from freeboard where no = #{no}
</delete>

<delete id="deleteReply" >
	delete from freply where board_no = #{no}
</delete>

</mapper>